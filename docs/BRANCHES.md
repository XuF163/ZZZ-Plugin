# 分支说明（自用仓库）

本仓库长期维护 **4 个分支**，用于区分「自用开发/运行」与「上游镜像参考」。

## 分支角色

### `dev`（自用：开发源码）
- 你日常改代码、做功能的分支。
- 后期会将 `dev` 的**编译产物**发布到 `master`（见下文“编译/发布关系”）。

### `master`（自用：运行/发布）
- 当前运行环境使用的分支（**生产/自用部署指向此分支**）。
- 规划：只承载从 `dev` 编译出来的产物（或至少以产物为主）。
- 约定：非必要不直接在 `master` 开发；通过 `dev -> master` 的发布流程来更新。

### `updev`（上游：dev 镜像）
- 自动同步 **上游仓库** 的 `dev` 分支（源码参考）。
- 用途：对比、评估、挑选上游改动；不作为你自用运行分支。

### `updist`（上游：main/dist 镜像）
- 自动同步 **上游仓库** 的 `main` 分支（通常代表“可用版本/产物侧”）。
- 用途：对比上游“可运行版本”与 `updev` 的关系，并作为你合并/评估时的参照基线。



## 编译/发布关系（类比上游）

你提到的「编译」可按上游的对应关系理解：

- 上游：`updev`（TS/源码侧） →（编译）→ `updist`（编译后产物/可用版本侧）
- 本仓库（规划）：`dev`（自用源码侧） →（编译）→ `master`（自用运行/发布侧）

当前阶段：由于你的运行环境也指向 `master`，因此暂时**不要**自动化触碰 `master` 的发布流程；先把分支结构和上游同步稳定下来。

## 上游同步（镜像分支）

`.github/workflows/sync-upstream-main.yml` 会将：
- `upstream/main` 同步到 `origin/updist`
- `upstream/dev` 同步到 `origin/updev`

镜像分支建议保持“只读心智模型”：
- 不在 `updev/updist` 上直接开发
- 只从它们 **merge/cherry-pick** 到 `dev`，用于功能参考与改动评估

## 推荐工作流（自用）

1) 同步上游镜像：更新 `updev/updist`
2) 在本仓库对比/评估：`dev` vs `updev/updist`
3) 选取需要的改动：将上游变更合入 `dev`
4) （后期）`dev` 编译产物发布到 `master`

